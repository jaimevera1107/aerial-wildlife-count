# ==============================================================
#  DATASET QUALITY CHECKER CONFIGURATION (HERDNET PIPELINE)
# ==============================================================
#  Compatible with: DatasetQualityCheckerV2
#  Purpose: Full quality verification, cleaning, and audit pipeline
# ==============================================================

# --------------------------------------------------------------
#  General settings
# --------------------------------------------------------------
output_dir: ../../data/outputs         # Output folder for all generated results (logs, reports, mirrors, etc.)
seed: 42                         # Random seed for deterministic operations
num_workers: 8                   # Number of threads for concurrent tasks (image IO, validation, copies)
allow_empty_images: false        # If true, images without annotations are retained

# --------------------------------------------------------------
#  Image directories by split
# --------------------------------------------------------------
#  These must exist and contain the raw dataset images.
#  Paths are relative from src/v1/ to the repository root
image_dirs:
  train: ../../data/train
  train_subframes: ../../data/train_subframes
  val: ../../data/val
  test: ../../data/test

# --------------------------------------------------------------
#  Annotation files (COCO-style)
# --------------------------------------------------------------
#  Paths to the annotation JSON files for each split.
#  Each file must follow the COCO structure: "images", "annotations", "categories".
#  Paths are relative from src/v1/ to the repository root
splits:
  train: ../../data/groundtruth/json/big_size/train_big_size_A_B_E_K_WH_WB.json
  val: ../../data/groundtruth/json/big_size/val_big_size_A_B_E_K_WH_WB.json
  test: ../../data/groundtruth/json/big_size/test_big_size_A_B_E_K_WH_WB.json
  train_subframes: ../../data/groundtruth/json/sub_frames/train_subframes_A_B_E_K_WH_WB.json

# --------------------------------------------------------------
#  Class definitions
# --------------------------------------------------------------
#  Names must match the category names in the COCO JSON files.
classes:
  - Buffalo
  - Elephant
  - Kob
  - Alcelaphinae
  - Warthog
  - Waterbuck

# ==============================================================
#  IMAGE VERIFICATION SETTINGS
# ==============================================================
verify:
  enabled: true                 # Enable/disable image verification stage
  format: jpg                   # Target format for re-saved verified images (jpg/png/tiff/webp/bmp)
  quality: 95                   # JPEG quality (ignored for PNG/TIFF)
  convert_rgb: true             # Convert images to RGB if not already
  fix_exif: true                # Correct EXIF orientation metadata
  output_dir: verified          # Subfolder name under output_dir for verified images
  min_res: [2000, 2000]         # Minimum accepted resolution [width, height]
  max_res: [10000, 10000]       # Maximum accepted resolution [width, height]

# ==============================================================
#  ANNOTATION VALIDATION
# ==============================================================
#  Controls semantic and geometric validation of bounding boxes.
annotations:
  format: coco                  # Annotation format (COCO expected)
  min_area: 100                 # Minimum allowed bounding box area (in pixels)
  max_area: 15000               # Maximum allowed bounding box area (in pixels)
  allow_crowd: false            # Keep (true) or remove (false) crowd annotations (iscrowd==1)
  remove_duplicates: true       # Remove duplicated boxes for the same image/category combination

# ==============================================================
#  FILTERING (GEOMETRIC VALIDATION)
# ==============================================================
#  Filters unrealistic bounding boxes after validation.
filter:
  iou_thresh: 0.9               # IoU threshold for duplicate/overlapping boxes
  min_aspect: 0.1               # Minimum width/height ratio
  max_aspect: 10.0              # Maximum width/height ratio

# ==============================================================
#  PIPELINE EXECUTION CONTROL
# ==============================================================
#  Optional section to selectively enable/disable stages.
pipeline:
  stage_1_verify: true          # Run image and mapping verification
  stage_2_validate: true        # Run annotation validation and filtering
  stage_3_mirror: true          # Build cleaned mirrored dataset
  stage_4_reports: true         # Generate reports and audit
  stage_5_finalize: true        # Create joined dataset and global summary

# ==============================================================
#  INTERNAL PATHS (AUTOGENERATED BY CLASS)
# ==============================================================
#  These fields are filled dynamically by DatasetQualityCheckerV2
#  and do not need to be defined manually, but are included here
#  for completeness.
validated_datasets: {}          # Populated after validation (split â†’ path)
cache_file: cache.json          # Image verification cache (autogenerated)
history_file: history.json      # Process history log (autogenerated)
